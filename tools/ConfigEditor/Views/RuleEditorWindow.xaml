<Window x:Class="ConfigEditor.Views.RuleEditorWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Edit Rule" SizeToContent="WidthAndHeight" WindowStartupLocation="CenterOwner"
        Background="{StaticResource SurfaceBrush}">
    <Grid Margin="16" Background="{StaticResource SurfaceBrush}">
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="180"/>
            <ColumnDefinition Width="360"/>
        </Grid.ColumnDefinitions>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <TextBlock Grid.Row="0" Grid.Column="0" Margin="0,6,12,6" Text="Enabled"/>
        <CheckBox Grid.Row="0" Grid.Column="1" IsChecked="{Binding Enabled, Mode=TwoWay}"/>

        <TextBlock Grid.Row="1" Grid.Column="0" Margin="0,6,12,6" Text="Name"/>
        <TextBox Grid.Row="1" Grid.Column="1" Text="{Binding Name, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>

        <TextBlock Grid.Row="2" Grid.Column="0" Margin="0,6,12,6" Text="Pattern"/>
        <TextBox Grid.Row="2" Grid.Column="1" Text="{Binding Pattern, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>

        <TextBlock Grid.Row="3" Grid.Column="0" Margin="0,6,12,6" Text="Action Type"/>
        <ComboBox Grid.Row="3" Grid.Column="1"
                  SelectedValuePath="Content"
                  SelectedValue="{Binding ActionType, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}">
            <ComboBoxItem Content="keystroke"/>
            <ComboBoxItem Content="command"/>
            <ComboBoxItem Content="spell"/>
            <ComboBoxItem Content="text"/>
        </ComboBox>

        <!-- Generic action value (hidden for command and spell types) -->
        <TextBlock Grid.Row="5" Grid.Column="0" Margin="0,6,12,6" Text="Action Value">
            <TextBlock.Style>
                <Style TargetType="TextBlock">
                    <Setter Property="Visibility" Value="Visible"/>
                    <Style.Triggers>
                        <DataTrigger Binding="{Binding ActionType}" Value="command">
                            <Setter Property="Visibility" Value="Collapsed"/>
                        </DataTrigger>
                        <DataTrigger Binding="{Binding ActionType}" Value="spell">
                            <Setter Property="Visibility" Value="Collapsed"/>
                        </DataTrigger>
                    </Style.Triggers>
                </Style>
            </TextBlock.Style>
        </TextBlock>
        <TextBox Grid.Row="5" Grid.Column="1" Text="{Binding ActionValue, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}">
            <TextBox.Style>
                <Style TargetType="TextBox">
                    <Setter Property="Visibility" Value="Visible"/>
                    <Style.Triggers>
                        <DataTrigger Binding="{Binding ActionType}" Value="command">
                            <Setter Property="Visibility" Value="Collapsed"/>
                        </DataTrigger>
                        <DataTrigger Binding="{Binding ActionType}" Value="spell">
                            <Setter Property="Visibility" Value="Collapsed"/>
                        </DataTrigger>
                    </Style.Triggers>
                </Style>
            </TextBox.Style>
        </TextBox>

        <!-- Command-specific UI: "/" + command + argument (argument optional) -->
        <TextBlock Grid.Row="4" Grid.Column="0" Margin="0,6,12,6" Text="Command">
            <TextBlock.Style>
                <Style TargetType="TextBlock">
                    <Setter Property="Visibility" Value="Collapsed"/>
                    <Style.Triggers>
                        <DataTrigger Binding="{Binding ActionType}" Value="command">
                            <Setter Property="Visibility" Value="Visible"/>
                        </DataTrigger>
                    </Style.Triggers>
                </Style>
            </TextBlock.Style>
        </TextBlock>
        <StackPanel Grid.Row="4" Grid.Column="1" Orientation="Horizontal">
            <StackPanel.Style>
                <Style TargetType="StackPanel">
                    <Setter Property="Visibility" Value="Collapsed"/>
                    <Style.Triggers>
                        <DataTrigger Binding="{Binding ActionType}" Value="command">
                            <Setter Property="Visibility" Value="Visible"/>
                        </DataTrigger>
                    </Style.Triggers>
                </Style>
            </StackPanel.Style>
            <Border Background="{StaticResource SurfaceBorderBrush}" BorderBrush="{StaticResource SurfaceBorderBrush}" BorderThickness="1" Padding="6,4" CornerRadius="4" Margin="0,0,6,0">
                <TextBlock Text="/"/>
            </Border>
            <TextBox x:Name="CommandNameText" Width="140" Margin="0,0,6,0"/>
            <TextBox x:Name="CommandArgText" Width="200"/>
        </StackPanel>

        <!-- Spell-specific UI: read-only '/cast', class dropdown, level range, spell dropdown -->
        <TextBlock Grid.Row="4" Grid.Column="0" Margin="0,6,12,6" Text="Spell">
            <TextBlock.Style>
                <Style TargetType="TextBlock">
                    <Setter Property="Visibility" Value="Collapsed"/>
                    <Style.Triggers>
                        <DataTrigger Binding="{Binding ActionType}" Value="spell">
                            <Setter Property="Visibility" Value="Visible"/>
                        </DataTrigger>
                    </Style.Triggers>
                </Style>
            </TextBlock.Style>
        </TextBlock>
        <StackPanel Grid.Row="4" Grid.Column="1" Orientation="Horizontal">
            <StackPanel.Style>
                <Style TargetType="StackPanel">
                    <Setter Property="Visibility" Value="Collapsed"/>
                    <Style.Triggers>
                        <DataTrigger Binding="{Binding ActionType}" Value="spell">
                            <Setter Property="Visibility" Value="Visible"/>
                        </DataTrigger>
                    </Style.Triggers>
                </Style>
            </StackPanel.Style>
            <Border Background="{StaticResource SurfaceBorderBrush}" BorderBrush="{StaticResource SurfaceBorderBrush}" BorderThickness="1" Padding="6,4" CornerRadius="4" Margin="0,0,6,0">
                <TextBlock Text="/cast"/>
            </Border>
            <ComboBox x:Name="SpellClassCombo" Width="110" Margin="6,0,6,0">
                <ComboBoxItem Content="Cleric"/>
                <ComboBoxItem Content="Shaman"/>
                <ComboBoxItem Content="Druid"/>
                <ComboBoxItem Content="Enchanter"/>
                <ComboBoxItem Content="Magician"/>
                <ComboBoxItem Content="Necromancer"/>
                <ComboBoxItem Content="Ranger"/>
                <ComboBoxItem Content="Wizard"/>
            </ComboBox>
            <TextBox x:Name="MinLevelText" Width="40" Margin="6,0,2,0" ToolTip="Min"/>
            <TextBox x:Name="MaxLevelText" Width="40" Margin="2,0,6,0" ToolTip="Max"/>
            <ComboBox x:Name="SpellNameCombo" Width="240" DisplayMemberPath="Name" SelectedValuePath="Name"/>
        </StackPanel>

        <TextBlock Grid.Row="6" Grid.Column="0" Margin="0,6,12,6" Text="Modifiers"/>
        <TextBox Grid.Row="6" Grid.Column="1" Text="{Binding Modifiers, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>

        <TextBlock Grid.Row="7" Grid.Column="0" Margin="0,6,12,6" Text="Cooldown (ms)"/>
        <TextBox Grid.Row="7" Grid.Column="1" Text="{Binding CooldownMs, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>

        <StackPanel Grid.Row="8" Grid.ColumnSpan="2" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,12,0,0">
            <Button Width="90" Margin="0,0,8,0" Content="OK" IsDefault="True" Click="Ok_Click"/>
            <Button Width="90" Content="Cancel" IsCancel="True"/>
        </StackPanel>
    </Grid>
</Window>

