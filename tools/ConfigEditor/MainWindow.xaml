<Window x:Class="ConfigEditor.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:ConfigEditor"
        mc:Ignorable="d"
        Title="EQ Log Config Editor" Height="720" Width="1100" MinHeight="600" MinWidth="900">
    <DockPanel>
        <Menu DockPanel.Dock="Top">
            <MenuItem Header="_File">
                <MenuItem Header="_Open..." Click="Open_Click" />
                <Separator />
                <MenuItem Header="_Save" Click="Save_Click" />
                <MenuItem Header="Save _As..." Click="SaveAs_Click" />
                <MenuItem Header="_Validate" Click="Validate_Click" />
                <Separator />
                <MenuItem Header="E_xit" Click="Exit_Click" />
            </MenuItem>
            <MenuItem Header="_Presets">
                <MenuItem Header="Insert preset..." Click="InsertPreset_Click" />
            </MenuItem>
        </Menu>

        <Border Margin="12" Padding="12" Background="{StaticResource SurfaceBrush}" BorderBrush="{StaticResource SurfaceBorderBrush}" BorderThickness="1" CornerRadius="6">
        <TabControl>
            <TabItem Header="General">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <Grid Margin="4">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="200" />
                            <ColumnDefinition Width="*" />
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                        </Grid.RowDefinitions>
                        <TextBlock Grid.Row="0" Grid.Column="0" Margin="0,10,12,6" Text="Log file path" />
                        <StackPanel Grid.Row="0" Grid.Column="1" Orientation="Horizontal">
                            <TextBox x:Name="LogFilePathText" Width="500" Margin="0,0,8,0" TextChanged="General_TextChanged"/>
                            <Button Content="Browse..." Click="BrowseLogFile_Click"/>
                        </StackPanel>

                        <TextBlock Grid.Row="1" Grid.Column="0" Margin="0,6,12,6" Text="Output directory" />
                        <StackPanel Grid.Row="1" Grid.Column="1" Orientation="Horizontal">
                            <TextBox x:Name="OutputDirectoryText" Width="500" Margin="0,0,8,0" TextChanged="General_TextChanged"/>
                            <Button Content="Browse..." Click="BrowseOutputDir_Click" />
                        </StackPanel>

                        <TextBlock Grid.Row="2" Grid.Column="0" Margin="0,6,12,6" Text="Polling interval (ms)" />
                        <TextBox Grid.Row="2" Grid.Column="1" x:Name="PollingIntervalText" Width="120" TextChanged="General_TextChanged"/>

                        <TextBlock Grid.Row="3" Grid.Column="0" Margin="0,6,12,6" Text="Parallel processing" />
                        <CheckBox Grid.Row="3" Grid.Column="1" x:Name="ParallelProcessingCheck" Checked="General_CheckChanged" Unchecked="General_CheckChanged" />

                        <TextBlock Grid.Row="4" Grid.Column="0" Margin="0,6,12,6" Text="Debug mode" />
                        <CheckBox Grid.Row="4" Grid.Column="1" x:Name="DebugModeCheck" Checked="General_CheckChanged" Unchecked="General_CheckChanged" />

                        <TextBlock Grid.Row="5" Grid.Column="0" Margin="0,6,12,6" Text="Max queue size (0 = unlimited)" />
                        <TextBox Grid.Row="5" Grid.Column="1" x:Name="MaxQueueSizeText" Width="120" TextChanged="General_TextChanged"/>

                        <TextBlock Grid.Row="6" Grid.Column="0" Margin="0,6,12,6" Text="Process errors" />
                        <CheckBox Grid.Row="6" Grid.Column="1" x:Name="ProcessErrorsCheck" Checked="General_CheckChanged" Unchecked="General_CheckChanged" />

                        <TextBlock Grid.Row="7" Grid.Column="0" Margin="0,6,12,6" Text="Process warnings" />
                        <CheckBox Grid.Row="7" Grid.Column="1" x:Name="ProcessWarningsCheck" Checked="General_CheckChanged" Unchecked="General_CheckChanged" />

                        <TextBlock Grid.Row="8" Grid.Column="0" Margin="0,6,12,6" Text="Process info" />
                        <CheckBox Grid.Row="8" Grid.Column="1" x:Name="ProcessInfoCheck" Checked="General_CheckChanged" Unchecked="General_CheckChanged" />
                    </Grid>
                </ScrollViewer>
            </TabItem>

            <TabItem Header="Rules">
                <DockPanel>
                    <ToolBar DockPanel.Dock="Top">
                        <Button Content="Add" Click="AddRule_Click" />
                        <Button Content="Duplicate" Click="DuplicateRule_Click" />
                        <Button Content="Delete" Click="DeleteRule_Click" />
                        <Separator />
                        <Button Background="{StaticResource AccentBrush}" Foreground="White" Content="Edit Steps..." Click="EditSteps_Click" />
                    </ToolBar>
                    <DataGrid x:Name="RulesGrid" AutoGenerateColumns="False" CanUserAddRows="False" IsReadOnly="False" Margin="8" SelectionMode="Extended" RowEditEnding="RulesGrid_RowEditEnding" CellEditEnding="RulesGrid_CellEditEnding" CurrentCellChanged="RulesGrid_CurrentCellChanged">
                        <DataGrid.Columns>
                            <DataGridCheckBoxColumn Header="Enabled" Binding="{Binding Enabled}" Width="80"/>
                            <DataGridTextColumn Header="Name" Width="200">
                                <DataGridTextColumn.Binding>
                                    <Binding Path="Name" UpdateSourceTrigger="PropertyChanged" Mode="TwoWay" />
                                </DataGridTextColumn.Binding>
                            </DataGridTextColumn>
                            <DataGridTextColumn Header="Pattern" Width="300">
                                <DataGridTextColumn.Binding>
                                    <Binding Path="Pattern" UpdateSourceTrigger="PropertyChanged" Mode="TwoWay" />
                                </DataGridTextColumn.Binding>
                            </DataGridTextColumn>
                            <DataGridComboBoxColumn Header="Action Type" Width="120">
                                <DataGridComboBoxColumn.SelectedItemBinding>
                                    <Binding Path="ActionType" Mode="TwoWay" UpdateSourceTrigger="PropertyChanged" />
                                </DataGridComboBoxColumn.SelectedItemBinding>
                                <DataGridComboBoxColumn.ItemsSource>
                                    <x:Array Type="{x:Type sys:String}" xmlns:sys="clr-namespace:System;assembly=mscorlib">
                                        <sys:String>keystroke</sys:String>
                                        <sys:String>command</sys:String>
                                        <sys:String>text</sys:String>
                                    </x:Array>
                                </DataGridComboBoxColumn.ItemsSource>
                            </DataGridComboBoxColumn>
                            <DataGridTextColumn Header="Action Value" Width="200">
                                <DataGridTextColumn.Binding>
                                    <Binding Path="ActionValue" UpdateSourceTrigger="PropertyChanged" Mode="TwoWay" />
                                </DataGridTextColumn.Binding>
                            </DataGridTextColumn>
                            <DataGridTextColumn Header="Modifiers" Width="90">
                                <DataGridTextColumn.Binding>
                                    <Binding Path="Modifiers" UpdateSourceTrigger="PropertyChanged" Mode="TwoWay" />
                                </DataGridTextColumn.Binding>
                            </DataGridTextColumn>
                            <DataGridTextColumn Header="Cooldown (ms)" Width="110">
                                <DataGridTextColumn.Binding>
                                    <Binding Path="CooldownMs" UpdateSourceTrigger="PropertyChanged" Mode="TwoWay" />
                                </DataGridTextColumn.Binding>
                            </DataGridTextColumn>
                            <DataGridTextColumn Header="Steps" Binding="{Binding Actions.Count}" Width="70"/>
                        </DataGrid.Columns>
                    </DataGrid>
                </DockPanel>
            </TabItem>
        </TabControl>
        </Border>
    </DockPanel>
</Window>


